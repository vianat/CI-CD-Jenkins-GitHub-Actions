pipeline {
	agent any

	stages {
		stage('Unit tests - backend') {
			steps {
				dir('bugtracker-backend') {
					sh 'go test -v ./...'
				}
			}
		}
		stage('ui tests - frontend') {
			agent {
				docker {
					image 'node:20-alpine'
					args '--privileged -v /var/run/docker.sock:/var/run/docker.sock'
					reuseNode true
				}
			}
			steps {
				dir('bugtracker-frontend') {
					sh '''
						npm ci
						npm test
					'''
				}
			}
		}
	}
}