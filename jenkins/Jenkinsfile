pipeline {
	agent any

	stages {
		stage('Unit tests - backend') {
			steps {
				dir('bugtracker-backend') {
					sh 'go test -v ./... 2>&1 | go-junit-report > test-results.xml'
				}
			}
			post {
				junit 'bugtracker-backend/test-results.xml
			}
		}

		stage('ui tests - frontend') {
			agent any
			steps {
				dir('bugtracker-frontend') {
					sh '''
                        node --version
                        npm --version

                        echo "=== Current Directory ==="
                        pwd
                        ls -la

                        echo "=== Running Tests ==="
                        npm ci --no-audit
                        npm test
                    '''
				}
			}
			post {
				always {
					junit 'bugtracker-frontend/test-results.xml'
				}
			}
		}
	}
}